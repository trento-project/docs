include::product-attributes.adoc[]


[[sec-trento-mcp-server-k8s]]
==== Kubernetes MCP deployment
:revdate: 2025-11-17

include::partials/kubernetes-placeholders.adoc[]

===== Enabling the MCP Server

When installing the complete {trserver} using Helm, the MCP Server is disabled by default. Enable it by passing `--set trento-mcp-server.enabled=true`:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true
----
====

[NOTE]
====
The examples in this guide do not specify a Kubernetes namespace for simplicity. By default, Helm will install to the `default` namespace. 

For production deployments, create and use a dedicated namespace.

Example:
[source,bash]
----
kubectl create namespace trento
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --namespace trento \
  --set trento-mcp-server.enabled=true \
  ...
----
====

The MCP Server will automatically connect to the {tr_web} and Wanda internal services within the {k8s} cluster.

===== Verifying the MCP Server Installation

. Check that the MCP Server Pod is running:
+
[source,bash]
----
kubectl get pods -l app.kubernetes.io/name=mcp-server
----
+
Example output:
+
[source,bash]
----
NAME                                       READY   STATUS    RESTARTS   AGE
trento-server-mcp-server-xxxxxxxxxx-xxxxx  1/1     Running   0          2m
----

. Check the logs:
+
[source,bash]
----
kubectl logs -l app.kubernetes.io/name=mcp-server
----

. Check the MCP Server health endpoints:
+
[source,bash]
----
# Expose the health check port from the Pod, as it is not exposed as a Kubernetes Service.
kubectl port-forward --namespace default \
  $(kubectl get pods --namespace default -l app.kubernetes.io/name=mcp-server -o jsonpath="{.items[0].metadata.name}") \
  8080:8080
----
+
[source,bash]
----
# Liveness endpoint:
curl http://localhost:8080/livez
----
+
[source,bash]
----
# Readiness endpoint:
curl http://localhost:8080/readyz
----
+
Example output:
+
[source,bash]
----
# Liveness:
{"info":{"name":"trento-mcp-server","version":"0.1.0"},"status":"up"}

# Readiness:
{"status":"up","details":{"mcp-server":{"status":"up","timestamp":"2025-10-09T12:11:09.528898849Z"},"wanda-api":{"status":"up","timestamp":"2025-10-09T12:11:09.544855047Z"},"web-api":{"status":"up","timestamp":"2025-10-09T12:11:09.544855047Z"}}}
----

===== {tr_mcp} Helm Configuration Options

The {tr_mcp} Helm chart supports various configuration options:

* <<mcp-customize-ingress-path,Customize Ingress Path>>
* <<mcp-disabling-tag-filtering,Disabling Tag Filtering>>
* <<mcp-adjust-log-verbosity,Adjust Log Verbosity>>
* <<mcp-adjust-resource-limits,Adjust Resource Limits>>
* <<mcp-disabling-health-check-probes,Disabling Health Check Probes>>

[[mcp-customize-ingress-path]]
====== Customize Ingress Path

By default, ingress is enabled.
To customize the ingress configuration:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.ingress.enabled=true \
  --set trento-mcp-server.ingress.hosts[0].host=TRENTO_SERVER_HOSTNAME \
  --set trento-mcp-server.ingress.hosts[0].paths[0].path=/mcp-server-trento \
  --set trento-mcp-server.ingress.hosts[0].paths[0].pathType=ImplementationSpecific
----
====

The MCP Server endpoint will be: `https://TRENTO_SERVER_HOSTNAME/mcp-server-trento/mcp`

[[mcp-disabling-tag-filtering]]
====== Disabling Tag Filtering

By default, only operations tagged with `MCP` are exposed. To expose all operations and remove tag filtering:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.mcpServer.tagFilter=[]
----
====

[NOTE]
====
You can also filter by different tags by setting `--set trento-mcp-server.mcpServer.tagFilter[0]=YourTag`.
====

[[mcp-adjust-log-verbosity]]
====== Adjust Log Verbosity

The default log level is `info`. Adjust it for debugging:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.mcpServer.verbosity=debug
----
====

[[mcp-adjust-resource-limits]]
====== Adjust Resource Limits

For production deployments with different resource requirements:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.resources.requests.cpu=100m \
  --set trento-mcp-server.resources.requests.memory=128Mi \
  --set trento-mcp-server.resources.limits.cpu=1000m \
  --set trento-mcp-server.resources.limits.memory=1Gi
----
====

[[mcp-disabling-health-check-probes]]
====== Disabling Health Check Probes

Health check probes are enabled by default. To disable them if needed:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=TRENTO_SERVER_HOSTNAME \
  --set trento-web.adminUser.password=ADMIN_PASSWORD \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.livenessProbe.enabled=false \
  --set trento-mcp-server.readinessProbe.enabled=false
----
====


===== Complete Configuration Example

Complete example that configures external access via a custom ingress path:

====
[source,bash]
----
helm upgrade --install trento-server oci://registry.suse.com/trento/trento-server \
  --set trento-web.trentoWebOrigin=https://trento.example.com \
  --set trento-web.adminUser.password=SecurePassword123 \
  --set trento-mcp-server.enabled=true \
  --set trento-mcp-server.mcpServer.trentoURL=https://trento.example.com \
  --set trento-mcp-server.ingress.hosts[0].host=trento.example.com \
  --set trento-mcp-server.ingress.hosts[0].paths[0].path=/mcp-server-trento \
  --set trento-mcp-server.ingress.hosts[0].paths[0].pathType=ImplementationSpecific
----
====
